---
title: "final"
author: "Jacob"
date: "5/3/2020"
output: pdf_document
---

```{r}
library(rvest)
library(tidyverse)
options(stringsAsFactors = FALSE)

songs_2010 <- "dataset-of-10s.csv"
songs_2000 <- "dataset-of-00s.csv"
songs_1990 <- "dataset-of-90s.csv"
songs_1980 <- "dataset-of-80s.csv"
songs_1970 <- "dataset-of-70s.csv"
songs_1960 <- "dataset-of-60s.csv"



song_files <- c(songs_2010,songs_2000,songs_1990,songs_1980,songs_1970,songs_1960)
song_df <- NULL
for (song_file in song_files){
  tmp_df <- read.csv(song_file)
  decade <- str_extract(song_file,"\\d{2}")
  tmp_df$decade <- decade
  song_df <- bind_rows(song_df,tmp_df)
}
song_df$decade <- ordered(song_df$decade, levels = c("60","70","80","90","00","10"))
glimpse(song_df)

```
The code chunk above takes music datasets from the 1960's, 1970's, 1980's, 1990's, 2000's, and 2010's and puts it together to make a larger dataframe containg all songs from all of the datasets. In addition the column "decade" is added containing the decade of each song. This is relevant for the rest of the PROJECT??? since it will allow us to see various aspects of each decade throughout. 


```{r graph}
song_df <- song_df %>% 
  select(-c(uri,key,valence,track,artist))
glimpse(song_df)

```
This code chunk is used to get rid of elements of the dataset that are not relevant to this. uri which is the url is not relevant to this as the key song and valence is not relevent ADD STUFF?. track and artist are strings meaning we can't use this in analyzing the data. However, if we wanted to see if there is a different chance for an artist to have a hit given that they have had one previously we could use this. (We would find the first instance of when the artist had a hit and come up with a formula that way)

```{r}

hits_only <- filter(song_df,target == 1) 
glimpse(hits_only)
```

```{r}
plot_avg_by_decade <- function(df,col){
  
  plotting <- df %>% group_by(decade) %>% 
    summarise(avg=mean({{col}}))
  ggplot(plotting) + geom_bar(stat= "identity",aes(x=decade,y = avg))
}
song_df %>% plot_avg_by_decade(tempo)


```
The code chunk above looks at tempo trends as decades progress. This graph includes songs that are both not hits and songs that are hits.



```{r}
plot_avg_by_decade <- function(df,col){

  plotting <- df %>% group_by(decade) %>% 
    summarise(avg=mean({{col}}))
  ggplot(plotting) + geom_bar(stat= "identity",aes(x=decade,y = avg))
}
hits_only %>% plot_avg_by_decade(tempo)


```
The code chunk above checks trends in songs that are hits. We then will compare the tempo to see if there are tempo differences between songs that are hits and songs that are not hits.



```{r}


```








